(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[157],{1958:function(e,s,t){Promise.resolve().then(t.bind(t,9445))},9445:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return v}});var a=t(7437),i=t(2265),l=t(9827),n=t(1713),r=t(1770),d=t(8320),c=t(2869),o=t(6070),x=t(5186),m=t(6815),u=t(3647),h=t(9116),j=t(9397),p=t(525),g=t(5252),f=t(5805);function v(){var e;let[s,t]=(0,i.useState)(!1),v=(0,l.NL)(),{data:b,isLoading:y}=(0,n.a)({queryKey:["campaigns"],queryFn:async()=>(await h.Z.get("/marketing/campaigns")).data}),{data:N}=(0,n.a)({queryKey:["marketing-dashboard"],queryFn:async()=>(await h.Z.get("/marketing/dashboard")).data}),w=(0,r.D)({mutationFn:async e=>(await h.Z.post("/marketing/campaigns",e)).data,onSuccess:()=>{v.invalidateQueries({queryKey:["campaigns"]}),t(!1)}});return y?(0,a.jsx)(d.c,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary-700 border-r-transparent"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Cargando..."})]})})}):(0,a.jsx)(d.c,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Marketing"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Gesti\xf3n de campa\xf1as y m\xe9tricas"})]}),(0,a.jsxs)(c.z,{onClick:()=>t(!s),children:[(0,a.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"Nueva Campa\xf1a"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-4",children:[(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ll,{className:"text-sm font-medium",children:"Total Campa\xf1as"}),(0,a.jsx)(p.Z,{className:"h-4 w-4 text-gray-500"})]}),(0,a.jsx)(o.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==N?void 0:N.totalCampaigns)||0})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ll,{className:"text-sm font-medium",children:"Presupuesto Total"}),(0,a.jsx)(g.Z,{className:"h-4 w-4 text-gray-500"})]}),(0,a.jsx)(o.aY,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",((null==N?void 0:N.totalBudget)||0).toLocaleString()]})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ll,{className:"text-sm font-medium",children:"Leads Generados"}),(0,a.jsx)(f.Z,{className:"h-4 w-4 text-gray-500"})]}),(0,a.jsx)(o.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==N?void 0:N.totalLeads)||0})})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(o.ll,{className:"text-sm font-medium",children:"Tasa Conversi\xf3n"}),(0,a.jsx)(p.Z,{className:"h-4 w-4 text-gray-500"})]}),(0,a.jsx)(o.aY,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[(null==N?void 0:null===(e=N.conversionRate)||void 0===e?void 0:e.toFixed(1))||0,"%"]})})]})]}),s&&(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.Ol,{children:(0,a.jsx)(o.ll,{children:"Crear Nueva Campa\xf1a"})}),(0,a.jsx)(o.aY,{children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=new FormData(e.currentTarget),t=JSON.parse(localStorage.getItem("user")||"{}");w.mutate({name:s.get("name"),channel:s.get("channel"),startDate:s.get("startDate"),endDate:s.get("endDate")||null,objective:s.get("objective")||null,budget:s.get("budget")?parseFloat(s.get("budget")):null,ownerId:t.id})},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m._,{htmlFor:"name",children:"Nombre de la Campa\xf1a"}),(0,a.jsx)(x.I,{id:"name",name:"name",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m._,{htmlFor:"channel",children:"Canal"}),(0,a.jsxs)(u.P,{id:"channel",name:"channel",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Seleccionar..."}),(0,a.jsx)("option",{value:"EMAIL",children:"Email"}),(0,a.jsx)("option",{value:"REDES_SOCIALES",children:"Redes Sociales"}),(0,a.jsx)("option",{value:"EVENTO",children:"Evento"}),(0,a.jsx)("option",{value:"REFERIDOS",children:"Referidos"}),(0,a.jsx)("option",{value:"WEB",children:"Web"}),(0,a.jsx)("option",{value:"GOOGLE_ADS",children:"Google Ads"}),(0,a.jsx)("option",{value:"FACEBOOK_ADS",children:"Facebook Ads"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m._,{htmlFor:"budget",children:"Presupuesto"}),(0,a.jsx)(x.I,{id:"budget",name:"budget",type:"number",step:"0.01"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m._,{htmlFor:"startDate",children:"Fecha Inicio"}),(0,a.jsx)(x.I,{id:"startDate",name:"startDate",type:"date",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m._,{htmlFor:"endDate",children:"Fecha Fin"}),(0,a.jsx)(x.I,{id:"endDate",name:"endDate",type:"date"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m._,{htmlFor:"objective",children:"Objetivo"}),(0,a.jsx)(x.I,{id:"objective",name:"objective"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),(0,a.jsx)(c.z,{type:"submit",disabled:w.isPending,children:w.isPending?"Creando...":"Crear Campa\xf1a"})]})]})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[null==b?void 0:b.map(e=>{var s,t,i;let l=(null===(s=e.opportunities)||void 0===s?void 0:s.length)||0,n=(null===(t=e.opportunities)||void 0===t?void 0:t.filter(e=>"GANADO"===e.stage).length)||0,r=(null===(i=e.opportunities)||void 0===i?void 0:i.filter(e=>"GANADO"===e.stage).reduce((e,s)=>e+s.estimatedValue,0))||0,d=e.budget&&e.budget>0?(r-e.budget)/e.budget*100:0;return(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.ll,{children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.objective})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-primary-100 text-primary-800 rounded",children:e.channel}),e.isActive?(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded",children:"Activa"}):(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded",children:"Inactiva"})]})]})}),(0,a.jsx)(o.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Presupuesto"}),(0,a.jsxs)("div",{className:"text-lg font-semibold",children:["$",(e.budget||0).toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Leads"}),(0,a.jsx)("div",{className:"text-lg font-semibold",children:l})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Ganados"}),(0,a.jsx)("div",{className:"text-lg font-semibold",children:n})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"ROI"}),(0,a.jsxs)("div",{className:"text-lg font-semibold ".concat(d>=0?"text-green-600":"text-red-600"),children:[d.toFixed(1),"%"]})]})]})})]},e.id)}),(!b||0===b.length)&&(0,a.jsx)(o.Zb,{children:(0,a.jsx)(o.aY,{className:"py-8 text-center text-gray-500",children:"No hay campa\xf1as creadas. Crea tu primera campa\xf1a para comenzar."})})]})]})})}},5186:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var a=t(7437),i=t(2265),l=t(1994);let n=i.forwardRef((e,s)=>{let{className:t,type:i,...n}=e;return(0,a.jsx)("input",{type:i,className:(0,l.W)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},6815:function(e,s,t){"use strict";t.d(s,{_:function(){return n}});var a=t(7437),i=t(2265),l=t(1994);let n=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)("label",{ref:s,className:(0,l.W)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...i})});n.displayName="Label"},3647:function(e,s,t){"use strict";t.d(s,{P:function(){return n}});var a=t(7437),i=t(2265),l=t(1994);let n=i.forwardRef((e,s)=>{let{className:t,children:i,...n}=e;return(0,a.jsx)("select",{className:(0,l.W)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n,children:i})});n.displayName="Select"},5252:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},9397:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},function(e){e.O(0,[301,21,429,713,82,971,117,744],function(){return e(e.s=1958)}),_N_E=e.O()}]);