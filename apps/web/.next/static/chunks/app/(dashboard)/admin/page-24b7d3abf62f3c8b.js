(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[772],{6376:function(e,t,s){Promise.resolve().then(s.bind(s,994))},994:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(7437),r=s(1713),l=s(8320),n=s(6070),i=s(9116),c=s(8736),d=s(5252),o=s(9763);let x=(0,o.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),m=(0,o.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);function h(){let{data:e,isLoading:t}=(0,r.a)({queryKey:["contracts"],queryFn:async()=>(await i.Z.get("/contracts")).data});if(t)return(0,a.jsx)(l.c,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary-700 border-r-transparent"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Cargando..."})]})})});let s={BORRADOR:"Borrador",ENVIADO:"Enviado",APROBADO:"Aprobado",FIRMADO:"Firmado",CANCELADO:"Cancelado"},o={PENDIENTE:"Pendiente",PARCIAL:"Parcial",PAGADO:"Pagado"},h={BORRADOR:"bg-gray-100 text-gray-800",ENVIADO:"bg-blue-100 text-blue-800",APROBADO:"bg-yellow-100 text-yellow-800",FIRMADO:"bg-green-100 text-green-800",CANCELADO:"bg-red-100 text-red-800"},u=(null==e?void 0:e.reduce((e,t)=>e+t.finalValue,0))||0,f=(null==e?void 0:e.filter(e=>"PENDIENTE"===e.paymentStatus).reduce((e,t)=>e+t.finalValue,0))||0,j=(null==e?void 0:e.filter(e=>"PAGADO"===e.paymentStatus).reduce((e,t)=>e+t.finalValue,0))||0;return(0,a.jsx)(l.c,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Administraci\xf3n"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Gesti\xf3n de contratos y facturaci\xf3n"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-4",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Total Contratos"}),(0,a.jsx)(c.Z,{className:"h-4 w-4 text-gray-500"})]}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==e?void 0:e.length)||0})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Valor Total"}),(0,a.jsx)(d.Z,{className:"h-4 w-4 text-gray-500"})]}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",u.toLocaleString()]})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Pendiente"}),(0,a.jsx)(x,{className:"h-4 w-4 text-gray-500"})]}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",f.toLocaleString()]})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Pagado"}),(0,a.jsx)(m,{className:"h-4 w-4 text-gray-500"})]}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",j.toLocaleString()]})})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[null==e?void 0:e.map(e=>{var t,r,l;return(0,a.jsxs)(n.Zb,{className:"cursor-pointer hover:shadow-lg transition",onClick:()=>window.location.href="/admin/contracts/".concat(e.id),children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(n.ll,{children:e.contractNumber}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:null===(r=e.opportunity)||void 0===r?void 0:null===(t=r.company)||void 0===t?void 0:t.name})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded ".concat(h[e.status]),children:s[e.status]}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded ".concat("PAGADO"===e.paymentStatus?"bg-green-100 text-green-800":"PARCIAL"===e.paymentStatus?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:o[e.paymentStatus]})]})]})}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Valor"}),(0,a.jsxs)("div",{className:"text-lg font-semibold",children:["$",e.finalValue.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Fecha Creaci\xf3n"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Factura"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:e.invoiceNumber||"Sin factura"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Tareas"}),(0,a.jsxs)("div",{className:"text-sm font-medium",children:[(null===(l=e.adminTasks)||void 0===l?void 0:l.length)||0," tareas"]})]})]})})]},e.id)}),(!e||0===e.length)&&(0,a.jsx)(n.Zb,{children:(0,a.jsx)(n.aY,{className:"py-8 text-center text-gray-500",children:'No hay contratos registrados. Los contratos se generan autom\xe1ticamente cuando una oportunidad pasa a estado "Ganado".'})})]})]})})}},8320:function(e,t,s){"use strict";s.d(t,{c:function(){return p}});var a=s(7437),r=s(2265),l=s(9376),n=s(7648),i=s(1994),c=s(5466),d=s(8896),o=s(5805),x=s(525),m=s(8736),h=s(7692),u=s(257);let f=[{name:"Dashboard",href:"/dashboard",icon:c.Z},{name:"OKR",href:"/okr",icon:d.Z},{name:"CRM",href:"/crm",icon:o.Z},{name:"Marketing",href:"/marketing",icon:x.Z},{name:"Administraci\xf3n",href:"/admin",icon:m.Z}];function j(){let e=(0,l.usePathname)();return(0,a.jsxs)("div",{className:"flex h-screen w-64 flex-col bg-gray-900 text-white",children:[(0,a.jsx)("div",{className:"flex h-16 items-center justify-center border-b border-gray-800",children:(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Reiki OKR/CRM"})}),(0,a.jsx)("nav",{className:"flex-1 space-y-1 px-2 py-4",children:f.map(t=>{let s=null==e?void 0:e.startsWith(t.href);return(0,a.jsxs)(n.default,{href:t.href,className:(0,i.W)("group flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors",s?"bg-primary-700 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"),children:[(0,a.jsx)(t.icon,{className:"mr-3 h-5 w-5"}),t.name]},t.name)})}),(0,a.jsx)("div",{className:"border-t border-gray-800 p-4",children:(0,a.jsxs)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user");let e=u.env.NEXT_PUBLIC_BASE_PATH||"/OKR";window.location.href="".concat(e,"/login")},className:"flex w-full items-center rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-800 hover:text-white",children:[(0,a.jsx)(h.Z,{className:"mr-3 h-5 w-5"}),"Cerrar Sesi\xf3n"]})})]})}function g(){var e;let[t,s]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=localStorage.getItem("user");e&&s(JSON.parse(e))},[]),(0,a.jsx)("header",{className:"bg-white border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between px-6",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Plataforma OKR/CRM"})}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:t&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-primary-700 flex items-center justify-center text-white font-semibold",children:null===(e=t.name)||void 0===e?void 0:e.charAt(0).toUpperCase()}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:t.name})]})})]})})}var N=s(257);function p(e){let{children:t}=e,s=(0,l.useRouter)(),[n,i]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{if(localStorage.getItem("token"))i(!1);else{let e=N.env.NEXT_PUBLIC_BASE_PATH||"/OKR";window.location.href="".concat(e,"/login")}},[s]),n)?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary-700 border-r-transparent"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Cargando..."})]})}):(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,a.jsx)(j,{}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden",children:[(0,a.jsx)(g,{}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:t})]})]})}},6070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},Zb:function(){return n},aY:function(){return d},ll:function(){return c}});var a=s(7437),r=s(2265),l=s(1994);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.W)("rounded-lg border border-gray-200 bg-white shadow-sm",s),...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.W)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,l.W)("text-2xl font-semibold leading-none tracking-tight",s),...r})});c.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,l.W)("text-sm text-gray-500",s),...r})}).displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.W)("p-6 pt-0",s),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.W)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},9116:function(e,t,s){"use strict";var a=s(3464),r=s(257);let l=a.Z.create({baseURL:"".concat("http://localhost:4000","/api")});l.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),l.interceptors.response.use(e=>e,e=>{var t;if((null===(t=e.response)||void 0===t?void 0:t.status)===401){localStorage.removeItem("token"),localStorage.removeItem("user");let e=r.env.NEXT_PUBLIC_BASE_PATH||"/OKR";window.location.href="".concat(e,"/login")}return Promise.reject(e)}),t.Z=l},5252:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])}},function(e){e.O(0,[301,21,429,713,971,117,744],function(){return e(e.s=6376)}),_N_E=e.O()}]);