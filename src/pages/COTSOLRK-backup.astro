---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import WhatsAppFloat from '../components/WhatsAppFloat.astro';
import SEO from '../components/SEO.astro';
import FontAwesome from '../components/FontAwesome.astro';
import { getCollection } from 'astro:content';

// Obtener todos los productos
const productos = await getCollection('productos');

// Funci贸n para extraer precio num茅rico
function extractPrice(priceString: string): number {
  const cleaned = priceString.replace(/[^0-9]/g, '');
  return parseInt(cleaned) || 0;
}

// Preparar productos con precio num茅rico
const productosConPrecio = productos.map(producto => ({
  ...producto,
  priceNumber: extractPrice(producto.data.price),
}));

// Convertir a JSON para el cliente
const productosJSON = JSON.stringify(productosConPrecio.map(p => ({
  id: p.slug,
  title: p.data.title,
  description: p.data.description,
  price: p.data.price,
  priceNumber: p.priceNumber,
  category: p.data.category,
  brand: p.data.brand || '',
  model: p.data.model || '',
  image: p.data.image,
  specifications: p.data.specifications,
  slug: p.slug,
})));
---

<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    <title>Cotizador Solar Profesional | Reiki Energ铆a Solar</title>
    <FontAwesome />
    <SEO 
      title="Cotizador Solar Profesional | Sistema de Cotizaci贸n Online"
      description="Cotizador profesional para sistemas solares. Genera cotizaciones detalladas con precios, descuentos e IVA. On-Grid y Off-Grid."
      canonical="/COTSOLRK"
      keywords="cotizador solar, cotizaci贸n energ铆a solar, cotizador paneles solares, sistema cotizaci贸n solar"
    />
  </head>
  <body>
    <Header />
    
    <main>
      <section class="cotizador-hero">
        <div class="container">
          <h1 class="hero-title">Cotizador Solar Profesional</h1>
          <p class="hero-subtitle">Genera cotizaciones detalladas para sistemas solares On-Grid y Off-Grid</p>
        </div>
      </section>

      <section class="cotizador-section">
        <div class="container">
          <div class="cotizador-layout">
            <!-- Panel de Productos -->
            <div class="productos-panel">
              <h2 class="panel-title">
                <i class="fas fa-boxes"></i>
                Productos Disponibles
              </h2>
              
              <div class="filters-bar">
                <select id="categoryFilter" class="filter-select">
                  <option value="all">Todas las categor铆as</option>
                  <option value="paneles">Paneles Solares</option>
                  <option value="inversores">Inversores</option>
                  <option value="baterias">Bater铆as</option>
                  <option value="controladores">Controladores</option>
                  <option value="protecciones">Protecciones</option>
                  <option value="reflectores">Reflectores</option>
                  <option value="cargadores">Cargadores</option>
                </select>
                <input 
                  type="text" 
                  id="searchProducts" 
                  class="search-input" 
                  placeholder="Buscar productos..."
                >
              </div>

              <div id="productosList" class="productos-list">
                <!-- Los productos se cargar谩n aqu铆 -->
              </div>
            </div>

            <!-- Panel de Cotizaci贸n -->
            <div class="cotizacion-panel">
              <h2 class="panel-title">
                <i class="fas fa-file-invoice-dollar"></i>
                Cotizaci贸n
              </h2>

              <!-- Datos del Cliente -->
              <div class="form-section">
                <h3 class="section-title">Datos del Cliente</h3>
                <div class="form-grid">
                  <div class="form-group">
                    <label for="clienteNombre">Nombre / Raz贸n Social *</label>
                    <input type="text" id="clienteNombre" class="form-input" required>
                  </div>
                  <div class="form-group">
                    <label for="clienteNit">NIT / C茅dula</label>
                    <input type="text" id="clienteNit" class="form-input">
                  </div>
                  <div class="form-group">
                    <label for="clienteTelefono">Tel茅fono *</label>
                    <input type="tel" id="clienteTelefono" class="form-input" required>
                  </div>
                  <div class="form-group">
                    <label for="clienteEmail">Email *</label>
                    <input type="email" id="clienteEmail" class="form-input" required>
                  </div>
                  <div class="form-group">
                    <label for="clienteDireccion">Direcci贸n</label>
                    <input type="text" id="clienteDireccion" class="form-input">
                  </div>
                  <div class="form-group">
                    <label for="clienteCiudad">Ciudad</label>
                    <input type="text" id="clienteCiudad" class="form-input">
                  </div>
                </div>
              </div>

              <!-- Datos de la Cotizaci贸n -->
              <div class="form-section">
                <h3 class="section-title">Datos de la Cotizaci贸n</h3>
                <div class="form-grid">
                  <div class="form-group">
                    <label for="cotizacionNumero">N煤mero de Cotizaci贸n</label>
                    <input type="text" id="cotizacionNumero" class="form-input" readonly>
                  </div>
                  <div class="form-group">
                    <label for="cotizacionFecha">Fecha</label>
                    <input type="date" id="cotizacionFecha" class="form-input">
                  </div>
                  <div class="form-group">
                    <label for="cotizacionValidez">Validez (d铆as)</label>
                    <input type="number" id="cotizacionValidez" class="form-input" value="30" min="1">
                  </div>
                  <div class="form-group">
                    <label for="tipoSistema">Tipo de Sistema</label>
                    <select id="tipoSistema" class="form-input">
                      <option value="on-grid">On-Grid (Conectado a Red)</option>
                      <option value="off-grid">Off-Grid (Aislado)</option>
                      <option value="hibrido">H铆brido</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Items de la Cotizaci贸n -->
              <div class="form-section">
                <h3 class="section-title">Items de la Cotizaci贸n</h3>
                <div id="cotizacionItems" class="cotizacion-items">
                  <p class="empty-message">No hay productos agregados. Selecciona productos del panel izquierdo.</p>
                </div>
              </div>

              <!-- Totales -->
              <div class="totales-section">
                <div class="total-row">
                  <span>Subtotal</span>
                  <span id="subtotal">$0</span>
                </div>
                <div class="total-row">
                  <span>Descuento (%)</span>
                  <input type="number" id="descuentoPorcentaje" class="descuento-input" value="0" min="0" max="100" step="0.1">
                </div>
                <div class="total-row">
                  <span>Descuento</span>
                  <span id="descuento">$0</span>
                </div>
                <div class="total-row">
                  <span>Subtotal con Descuento</span>
                  <span id="subtotalDescuento">$0</span>
                </div>
                <div class="total-row">
                  <span>IVA (19%)</span>
                  <span id="iva">$0</span>
                </div>
                <div class="total-row total-final">
                  <span>TOTAL</span>
                  <span id="total">$0</span>
                </div>
              </div>

              <!-- Acciones -->
              <div class="acciones-section">
                <button id="btnEnviarWhatsApp" class="btn-primary">
                  <i class="fab fa-whatsapp"></i>
                  Enviar por WhatsApp
                </button>
                <button id="btnGenerarPDF" class="btn-secondary">
                  <i class="fas fa-file-pdf"></i>
                  Generar PDF
                </button>
                <button id="btnLimpiar" class="btn-outline">
                  <i class="fas fa-trash"></i>
                  Limpiar
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    
    <Footer />
    <WhatsAppFloat />
  </body>
</html>

<script define:vars={{ productosJSON }}>
  // Datos
  const productos = JSON.parse(productosJSON);
  let cotizacionItems = [];
  let currentCategory = 'all';
  let searchTerm = '';

  // Inicializar
  document.addEventListener('DOMContentLoaded', function() {
    // Generar n煤mero de cotizaci贸n
    const numeroCotizacion = 'COT-' + new Date().getFullYear() + '-' + String(Math.floor(Math.random() * 10000)).padStart(4, '0');
    document.getElementById('cotizacionNumero').value = numeroCotizacion;
    
    // Fecha actual
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('cotizacionFecha').value = today;

    // Cargar productos
    renderProductos();
    
    // Event listeners
    document.getElementById('categoryFilter').addEventListener('change', function(e) {
      currentCategory = e.target.value;
      renderProductos();
    });

    document.getElementById('searchProducts').addEventListener('input', function(e) {
      searchTerm = e.target.value.toLowerCase();
      renderProductos();
    });

    document.getElementById('descuentoPorcentaje').addEventListener('input', calcularTotales);
    
    document.getElementById('btnEnviarWhatsApp').addEventListener('click', enviarWhatsApp);
    document.getElementById('btnGenerarPDF').addEventListener('click', generarPDF);
    document.getElementById('btnLimpiar').addEventListener('click', limpiarCotizacion);
  });

  // Renderizar productos
  function renderProductos() {
    const container = document.getElementById('productosList');
    const filtered = productos.filter(p => {
      const matchCategory = currentCategory === 'all' || p.category === currentCategory;
      const matchSearch = !searchTerm || 
        p.title.toLowerCase().includes(searchTerm) ||
        (p.brand && p.brand.toLowerCase().includes(searchTerm)) ||
        (p.model && p.model.toLowerCase().includes(searchTerm));
      return matchCategory && matchSearch;
    });

    if (filtered.length === 0) {
      container.innerHTML = '<p class="empty-message">No se encontraron productos</p>';
      return;
    }

    container.innerHTML = filtered.map(producto => `
      <div class="producto-card" data-id="${producto.id}">
        <div class="producto-info">
          <h4 class="producto-title">${producto.title}</h4>
          ${producto.brand ? `<p class="producto-brand">${producto.brand}${producto.model ? ' - ' + producto.model : ''}</p>` : ''}
          <p class="producto-price">${producto.price}</p>
        </div>
        <button class="btn-add-producto" onclick="agregarProducto('${producto.id}')">
          <i class="fas fa-plus"></i>
          Agregar
        </button>
      </div>
    `).join('');
  }

  // Agregar producto a cotizaci贸n
  window.agregarProducto = function(productId) {
    const producto = productos.find(p => p.id === productId);
    if (!producto) return;

    const existing = cotizacionItems.find(item => item.id === productId);
    if (existing) {
      existing.cantidad += 1;
    } else {
      cotizacionItems.push({
        id: producto.id,
        title: producto.title,
        brand: producto.brand || '',
        model: producto.model || '',
        precioUnitario: producto.priceNumber,
        cantidad: 1,
        descuento: 0,
      });
    }

    renderCotizacionItems();
    calcularTotales();
  };

  // Renderizar items de cotizaci贸n
  function renderCotizacionItems() {
    const container = document.getElementById('cotizacionItems');
    
    if (cotizacionItems.length === 0) {
      container.innerHTML = '<p class="empty-message">No hay productos agregados. Selecciona productos del panel izquierdo.</p>';
      return;
    }

    container.innerHTML = cotizacionItems.map((item, index) => `
      <div class="cotizacion-item">
        <div class="item-info">
          <h4>${item.title}</h4>
          ${item.brand ? `<p class="item-details">${item.brand}${item.model ? ' - ' + item.model : ''}</p>` : ''}
        </div>
        <div class="item-controls">
          <div class="control-group">
            <label>Cantidad</label>
            <input type="number" value="${item.cantidad}" min="1" 
              onchange="actualizarCantidad(${index}, this.value)">
          </div>
          <div class="control-group">
            <label>Precio Unit.</label>
            <input type="text" value="${formatCOP(item.precioUnitario)}" 
              onchange="actualizarPrecio(${index}, this.value)">
          </div>
          <div class="control-group">
            <label>Desc. (%)</label>
            <input type="number" value="${item.descuento}" min="0" max="100" step="0.1"
              onchange="actualizarDescuento(${index}, this.value)">
          </div>
          <div class="control-group">
            <label>Subtotal</label>
            <span class="item-subtotal">${formatCOP(calcularSubtotalItem(item))}</span>
          </div>
          <button class="btn-remove" onclick="eliminarItem(${index})">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    `).join('');
  }

  // Calcular subtotal de un item
  function calcularSubtotalItem(item) {
    const subtotal = item.precioUnitario * item.cantidad;
    const descuento = subtotal * (item.descuento / 100);
    return subtotal - descuento;
  }

  // Actualizar cantidad
  window.actualizarCantidad = function(index, cantidad) {
    cotizacionItems[index].cantidad = Math.max(1, parseInt(cantidad) || 1);
    renderCotizacionItems();
    calcularTotales();
  };

  // Actualizar precio
  window.actualizarPrecio = function(index, precioStr) {
    const precio = extractPrice(precioStr);
    cotizacionItems[index].precioUnitario = precio;
    renderCotizacionItems();
    calcularTotales();
  };

  // Actualizar descuento
  window.actualizarDescuento = function(index, descuento) {
    cotizacionItems[index].descuento = Math.max(0, Math.min(100, parseFloat(descuento) || 0));
    renderCotizacionItems();
    calcularTotales();
  };

  // Eliminar item
  window.eliminarItem = function(index) {
    cotizacionItems.splice(index, 1);
    renderCotizacionItems();
    calcularTotales();
  };

  // Calcular totales
  function calcularTotales() {
    // Subtotal de todos los items
    const subtotal = cotizacionItems.reduce((sum, item) => sum + calcularSubtotalItem(item), 0);
    
    // Descuento general
    const descuentoPorcentaje = parseFloat(document.getElementById('descuentoPorcentaje').value) || 0;
    const descuento = subtotal * (descuentoPorcentaje / 100);
    const subtotalDescuento = subtotal - descuento;
    
    // IVA (19%)
    const iva = subtotalDescuento * 0.19;
    const total = subtotalDescuento + iva;

    // Actualizar UI
    document.getElementById('subtotal').textContent = formatCOP(subtotal);
    document.getElementById('descuento').textContent = formatCOP(descuento);
    document.getElementById('subtotalDescuento').textContent = formatCOP(subtotalDescuento);
    document.getElementById('iva').textContent = formatCOP(iva);
    document.getElementById('total').textContent = formatCOP(total);
  }

  // Extraer precio num茅rico
  function extractPrice(priceString) {
    const cleaned = String(priceString).replace(/[^0-9]/g, '');
    return parseInt(cleaned) || 0;
  }

  // Formatear precio
  function formatCOP(num) {
    return new Intl.NumberFormat('es-CO', {
      style: 'currency',
      currency: 'COP',
      minimumFractionDigits: 0,
      maximumFractionDigits: 0,
    }).format(num);
  }

  // Enviar por WhatsApp
  function enviarWhatsApp() {
    const clienteNombre = document.getElementById('clienteNombre').value;
    const clienteTelefono = document.getElementById('clienteTelefono').value;
    const clienteEmail = document.getElementById('clienteEmail').value;
    const cotizacionNumero = document.getElementById('cotizacionNumero').value;
    const tipoSistema = document.getElementById('tipoSistema').value;

    if (!clienteNombre || !clienteTelefono || !clienteEmail) {
      alert('Por favor completa los datos del cliente (Nombre, Tel茅fono y Email son obligatorios)');
      return;
    }

    if (cotizacionItems.length === 0) {
      alert('Agrega al menos un producto a la cotizaci贸n');
      return;
    }

    // Construir mensaje
    let mensaje = ` *COTIZACIN ${cotizacionNumero}*\n\n`;
    mensaje += `* DATOS DEL CLIENTE:*\n`;
    mensaje += `Nombre: ${clienteNombre}\n`;
    if (document.getElementById('clienteNit').value) {
      mensaje += `NIT/C茅dula: ${document.getElementById('clienteNit').value}\n`;
    }
    mensaje += `Tel茅fono: ${clienteTelefono}\n`;
    mensaje += `Email: ${clienteEmail}\n`;
    if (document.getElementById('clienteDireccion').value) {
      mensaje += `Direcci贸n: ${document.getElementById('clienteDireccion').value}\n`;
    }
    if (document.getElementById('clienteCiudad').value) {
      mensaje += `Ciudad: ${document.getElementById('clienteCiudad').value}\n`;
    }
    mensaje += `\n* ITEMS DE LA COTIZACIN:*\n`;
    
    cotizacionItems.forEach((item, index) => {
      const subtotalItem = calcularSubtotalItem(item);
      mensaje += `\n${index + 1}. ${item.title}\n`;
      if (item.brand) mensaje += `   Marca: ${item.brand}${item.model ? ' - ' + item.model : ''}\n`;
      mensaje += `   Cantidad: ${item.cantidad}\n`;
      mensaje += `   Precio Unit: ${formatCOP(item.precioUnitario)}\n`;
      if (item.descuento > 0) {
        mensaje += `   Descuento: ${item.descuento}%\n`;
      }
      mensaje += `   Subtotal: ${formatCOP(subtotalItem)}\n`;
    });

    mensaje += `\n* RESUMEN FINANCIERO:*\n`;
    const subtotal = cotizacionItems.reduce((sum, item) => sum + calcularSubtotalItem(item), 0);
    const descuentoPorcentaje = parseFloat(document.getElementById('descuentoPorcentaje').value) || 0;
    const descuento = subtotal * (descuentoPorcentaje / 100);
    const subtotalDescuento = subtotal - descuento;
    const iva = subtotalDescuento * 0.19;
    const total = subtotalDescuento + iva;

    mensaje += `Subtotal: ${formatCOP(subtotal)}\n`;
    if (descuento > 0) {
      mensaje += `Descuento (${descuentoPorcentaje}%): ${formatCOP(descuento)}\n`;
      mensaje += `Subtotal con Descuento: ${formatCOP(subtotalDescuento)}\n`;
    }
    mensaje += `IVA (19%): ${formatCOP(iva)}\n`;
    mensaje += `*TOTAL: ${formatCOP(total)}*\n`;

    mensaje += `\n* INFORMACIN ADICIONAL:*\n`;
    mensaje += `Tipo de Sistema: ${document.getElementById('tipoSistema').options[document.getElementById('tipoSistema').selectedIndex].text}\n`;
    mensaje += `Fecha: ${document.getElementById('cotizacionFecha').value}\n`;
    mensaje += `Validez: ${document.getElementById('cotizacionValidez').value} d铆as\n`;

    mensaje += `\n_Esta cotizaci贸n fue generada desde el sistema web de Reiki Energ铆a Solar_`;

    // Enviar por WhatsApp
    const numero = '573245737413';
    const mensajeEncoded = encodeURIComponent(mensaje);
    window.open(`https://wa.me/${numero}?text=${mensajeEncoded}`, '_blank');
  }

  // Generar PDF (placeholder - puede implementarse m谩s adelante)
  function generarPDF() {
    if (cotizacionItems.length === 0) {
      alert('Agrega al menos un producto a la cotizaci贸n');
      return;
    }
    
    // Por ahora, mostrar un mensaje informativo
    alert('La generaci贸n de PDF estar谩 disponible pr贸ximamente. Por ahora puedes usar "Enviar por WhatsApp" para compartir la cotizaci贸n.');
    
    // TODO: Implementar generaci贸n de PDF usando una librer铆a como jsPDF o similar
  }

  // Limpiar cotizaci贸n
  function limpiarCotizacion() {
    if (confirm('驴Est谩s seguro de limpiar toda la cotizaci贸n?')) {
      cotizacionItems = [];
      document.getElementById('clienteNombre').value = '';
      document.getElementById('clienteNit').value = '';
      document.getElementById('clienteTelefono').value = '';
      document.getElementById('clienteEmail').value = '';
      document.getElementById('clienteDireccion').value = '';
      document.getElementById('clienteCiudad').value = '';
      document.getElementById('descuentoPorcentaje').value = '0';
      renderCotizacionItems();
      calcularTotales();
    }
  }
</script>

<style>
  .cotizador-hero {
    padding: 6rem 2rem 3rem;
    background: linear-gradient(135deg, #6b2181 0%, #8b2a9b 100%);
    color: white;
    text-align: center;
  }

  .container {
    max-width: 1400px;
    margin: 0 auto;
  }

  .hero-title {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 1rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .hero-subtitle {
    font-size: 1.3rem;
    color: rgba(255, 255, 255, 0.9);
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .cotizador-section {
    padding: 3rem 2rem;
    background: #f9fafb;
    min-height: 80vh;
  }

  .cotizador-layout {
    display: grid;
    grid-template-columns: 1fr 1.2fr;
    gap: 2rem;
    align-items: start;
  }

  .productos-panel,
  .cotizacion-panel {
    background: white;
    border-radius: 20px;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  }

  .panel-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .panel-title i {
    color: #6b2181;
  }

  .filters-bar {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .filter-select,
  .search-input {
    flex: 1;
    padding: 0.75rem 1rem;
    border: 2px solid #e5e7eb;
    border-radius: 10px;
    font-size: 1rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .filter-select:focus,
  .search-input:focus {
    outline: none;
    border-color: #6b2181;
  }

  .productos-list {
    max-height: 600px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .producto-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    transition: all 0.2s ease;
  }

  .producto-card:hover {
    border-color: #6b2181;
    box-shadow: 0 2px 8px rgba(107, 33, 129, 0.2);
  }

  .producto-info {
    flex: 1;
  }

  .producto-title {
    font-size: 1rem;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 0.25rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .producto-brand {
    font-size: 0.85rem;
    color: #6b7280;
    margin-bottom: 0.5rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .producto-price {
    font-size: 1rem;
    font-weight: 700;
    color: #6b2181;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .btn-add-producto {
    background: linear-gradient(135deg, #6b2181, #8b2a9b);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .btn-add-producto:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(107, 33, 129, 0.4);
  }

  .form-section {
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: 2px solid #e5e7eb;
  }

  .section-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 1rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .form-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }

  .form-group {
    display: flex;
    flex-direction: column;
  }

  .form-group label {
    font-size: 0.9rem;
    font-weight: 500;
    color: #6b7280;
    margin-bottom: 0.5rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .form-input {
    padding: 0.75rem 1rem;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    font-size: 1rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    transition: border-color 0.2s ease;
  }

  .form-input:focus {
    outline: none;
    border-color: #6b2181;
  }

  .cotizacion-items {
    max-height: 400px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .cotizacion-item {
    padding: 1rem;
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    background: #f9fafb;
  }

  .item-info h4 {
    font-size: 1rem;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 0.25rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .item-details {
    font-size: 0.85rem;
    color: #6b7280;
    margin-bottom: 1rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .item-controls {
    display: grid;
    grid-template-columns: repeat(4, 1fr) auto;
    gap: 0.75rem;
    align-items: end;
  }

  .control-group {
    display: flex;
    flex-direction: column;
  }

  .control-group label {
    font-size: 0.75rem;
    color: #6b7280;
    margin-bottom: 0.25rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .control-group input {
    padding: 0.5rem;
    border: 2px solid #e5e7eb;
    border-radius: 6px;
    font-size: 0.9rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .item-subtotal {
    font-weight: 700;
    color: #6b2181;
    font-size: 0.95rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .btn-remove {
    background: #ef4444;
    color: white;
    border: none;
    padding: 0.5rem;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .btn-remove:hover {
    background: #dc2626;
  }

  .totales-section {
    background: #f9fafb;
    padding: 1.5rem;
    border-radius: 12px;
    margin-bottom: 2rem;
  }

  .total-row {
    display: flex;
    justify-content: space-between;
    padding: 0.75rem 0;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .total-row:not(:last-child) {
    border-bottom: 1px solid #e5e7eb;
  }

  .total-row span:first-child {
    color: #6b7280;
  }

  .total-row span:last-child {
    font-weight: 600;
    color: #1f2937;
  }

  .descuento-input {
    width: 80px;
    padding: 0.5rem;
    border: 2px solid #e5e7eb;
    border-radius: 6px;
    text-align: right;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .total-final {
    font-size: 1.3rem;
    font-weight: 700;
    color: #6b2181;
    padding-top: 1rem;
    border-top: 2px solid #6b2181;
    margin-top: 0.5rem;
  }

  .acciones-section {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .btn-primary,
  .btn-secondary,
  .btn-outline {
    flex: 1;
    padding: 1rem 2rem;
    border: none;
    border-radius: 10px;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.2s ease;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }

  .btn-primary {
    background: linear-gradient(135deg, #25D366, #128C7E);
    color: white;
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(37, 211, 102, 0.4);
  }

  .btn-secondary {
    background: linear-gradient(135deg, #6b2181, #8b2a9b);
    color: white;
  }

  .btn-secondary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(107, 33, 129, 0.4);
  }

  .btn-outline {
    background: white;
    color: #6b2181;
    border: 2px solid #6b2181;
  }

  .btn-outline:hover {
    background: #6b2181;
    color: white;
  }

  .empty-message {
    text-align: center;
    color: #6b7280;
    padding: 2rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  @media (max-width: 1024px) {
    .cotizador-layout {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 768px) {
    .hero-title {
      font-size: 2rem;
    }

    .form-grid {
      grid-template-columns: 1fr;
    }

    .item-controls {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .acciones-section {
      flex-direction: column;
    }
  }
</style>

