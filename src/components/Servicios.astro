---
import { getCollection } from 'astro:content';

// Obtener todos los servicios ordenados
const servicios = await getCollection('servicios');
const serviciosOrdenados = servicios.sort((a, b) => (a.data.order || 0) - (b.data.order || 0));
---

{serviciosOrdenados.map((servicio, index) => (
  <section id={`servicio-${index + 1}`} class={`servicio-section ${index % 2 === 0 ? 'servicio-left' : 'servicio-right'} ${index === 0 ? 'first-section' : ''}`}>
  <div class="container">
          <div class="servicio-content">
            {index % 2 === 0 ? (
              <>
                <!-- Imagen a la izquierda -->
                <div class="servicio-image-container">
                  <img 
                src={index === 0 ? "/energia solar vivienda.png" : index === 1 ? "/images/Eenergia solar en empresas de medellin.png" : index === 2 ? "/images/estación de energía solar móvil en Colombia.png" : index === 3 ? "/images/Bombeo solar en Colombia.png" : servicio.data.image} 
                    alt={servicio.data.title}
                    class="servicio-image"
                    loading="lazy"
                  />
                </div>
                
                <!-- Contenido a la derecha -->
                <div class="servicio-info">
                  <h3 class="servicio-title">{servicio.data.title}</h3>
                  <p class="servicio-description">{servicio.data.description}</p>
                  
                  <div class="servicio-benefits">
                    <h4 class="benefits-title">Beneficios:</h4>
                    <ul class="benefits-list">
                      {servicio.data.benefits.map((benefit) => (
                        <li class="benefit-item">
                          {benefit}
                        </li>
                      ))}
                    </ul>
                  </div>
                  
                  <div class="servicio-cta">
                <a href={`/servicios/${servicio.slug}`} class="cta-button">
                      {servicio.data.cta.text}
                    </a>
                  </div>
                </div>
              </>
            ) : (
              <>
                <!-- Contenido a la izquierda -->
                <div class="servicio-info">
                  <h3 class="servicio-title">{servicio.data.title}</h3>
                  <p class="servicio-description">{servicio.data.description}</p>
                  
                  <div class="servicio-benefits">
                    <h4 class="benefits-title">Beneficios:</h4>
                    <ul class="benefits-list">
                      {servicio.data.benefits.map((benefit) => (
                        <li class="benefit-item">
                          {benefit}
                        </li>
                      ))}
                    </ul>
                  </div>
                  
                  <div class="servicio-cta">
                <a href={`/servicios/${servicio.slug}`} class="cta-button">
                      {servicio.data.cta.text}
                    </a>
                  </div>
                </div>
                
                <!-- Imagen a la derecha -->
                <div class="servicio-image-container">
                  <img 
                src={index === 1 ? "/images/Eenergia solar en empresas de medellin.png" : index === 2 ? "/images/estación de energía solar móvil en Colombia.png" : index === 3 ? "/images/Bombeo solar en Colombia.png" : servicio.data.image} 
                    alt={servicio.data.title}
                    class="servicio-image"
                    loading="lazy"
                  />
                </div>
              </>
            )}
          </div>
        </div>
  </section>
      ))}

<style>
  .servicio-section {
    padding: 1.5rem 0;
    position: relative;
    overflow: visible;
  }

  .servicio-section.servicio-left {
    background: #6b2181;
    position: relative;
  }

  .servicio-section.first-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 20%;
    background: linear-gradient(180deg, #ffffff 0%, #6b2181 100%);
    z-index: 1;
  }

  .servicio-section.servicio-right {
    background: #6b2181;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
    position: relative;
    z-index: 2;
  }

  .servicio-section {
    opacity: 1;
    perspective: 1000px;
    transform-style: preserve-3d;
  }

  .servicio-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;
    border-radius: 20px;
    padding: 3rem;
    box-shadow: 0 10px 40px rgba(107, 33, 129, 0.1);
    position: relative;
    overflow: visible;
    opacity: 0;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.4s ease, opacity 0.8s ease;
    transform-style: preserve-3d;
    will-change: transform;
    cursor: pointer;
  }

  .servicio-left .servicio-content {
    background: rgba(107, 33, 129, 0.8);
    backdrop-filter: blur(10px);
    box-shadow: 0 10px 40px rgba(107, 33, 129, 0.2);
    color: white;
    transform: translateX(-200px);
  }

  .servicio-right .servicio-content {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
    transform: translateX(200px);
  }

  .servicio-section.visible .servicio-content {
    opacity: 1;
    transform: translateX(0);
  }

  /* Hover effect - debe estar después de .visible para tener mayor especificidad */
  .servicio-section.visible .servicio-left .servicio-content:hover {
    transform: translateX(0) rotateY(10deg) rotateX(-4deg) translateZ(40px) scale(1.03) !important;
    box-shadow: 0 35px 90px rgba(107, 33, 129, 0.7) !important;
  }

  .servicio-section.visible .servicio-right .servicio-content:hover {
    transform: translateX(0) rotateY(-10deg) rotateX(-4deg) translateZ(40px) scale(1.03) !important;
    box-shadow: 0 35px 90px rgba(0, 0, 0, 0.8) !important;
  }


  .servicio-image-container {
    position: relative;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  }

  .servicio-image {
    width: 100%;
    height: 400px;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .servicio-image-container:hover .servicio-image {
    transform: scale(1.05);
  }

  .servicio-info {
    padding: 1rem 0;
  }

  .servicio-title {
    font-size: 2.2rem;
    margin-bottom: 1.5rem;
    font-weight: 600;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    line-height: 1.3;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), text-shadow 0.4s ease;
    transform-style: preserve-3d;
  }

  .servicio-section.visible .servicio-content:hover .servicio-title {
    transform: scale(1.15) translateZ(20px) !important;
    text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
  }

  .servicio-left .servicio-title {
    color: white;
  }

  .servicio-right .servicio-title {
    color: white;
  }

  .servicio-description {
    font-size: 1.1rem;
    line-height: 1.7;
    margin-bottom: 2rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .servicio-left .servicio-description {
    color: #e5e7eb;
  }

  .servicio-right .servicio-description {
    color: #e5e7eb;
  }

  .servicio-benefits {
    margin-bottom: 2.5rem;
  }

  .benefits-title {
    font-size: 1.3rem;
    margin-bottom: 1rem;
    font-weight: 600;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .servicio-left .benefits-title {
    color: white;
  }

  .servicio-right .benefits-title {
    color: white;
  }

  .benefits-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .benefit-item {
    display: flex;
    align-items: center;
    margin-bottom: 0.8rem;
    font-size: 1rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    transition: all 0.3s ease;
  }

  .servicio-left .benefit-item {
    color: #d1d5db;
  }

  .servicio-right .benefit-item {
    color: #d1d5db;
  }

  .servicio-left .benefit-item:hover {
    color: white;
    transform: translateX(5px);
  }

  .servicio-right .benefit-item:hover {
    color: white;
    transform: translateX(5px);
  }


  .servicio-cta {
    margin-top: 2rem;
  }

  .cta-button {
    display: inline-block;
    background: linear-gradient(135deg, #FFD700, #FFA500);
    color: #1f2937;
    padding: 1rem 2rem;
    border-radius: 50px;
    text-decoration: none;
    font-weight: 600;
    font-size: 1.1rem;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
    position: relative;
    overflow: hidden;
  }

  .cta-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s ease;
  }

  .cta-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6);
    background: linear-gradient(135deg, #FFA500, #FFD700);
  }

  .cta-button:hover::before {
    left: 100%;
  }


  /* Responsive Design */
  @media (max-width: 1024px) {
    .servicio-section {
      padding: 1.25rem 0;
  }

    .servicio-content {
      gap: 2.5rem;
      padding: 2.5rem;
  }
  }

  @media (max-width: 768px) {
    .servicio-section {
      padding: 1rem 0;
    }

    .servicio-left .servicio-content {
      transform: translateX(-100px);
    }

    .servicio-right .servicio-content {
      transform: translateX(100px);
    }

    .container {
      padding: 0 1rem;
    }

    .servicio-content {
      grid-template-columns: 1fr;
      gap: 2rem;
      padding: 2rem;
    }

    .servicio-image {
      height: 300px;
    }

    .servicio-title {
      font-size: 1.8rem;
    }

    .servicio-description {
      font-size: 1rem;
    }

    .benefits-title {
      font-size: 1.2rem;
    }

    .cta-button {
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      width: 100%;
      text-align: center;
    }

    .servicio-cta {
      width: 100%;
    }
  }

  @media (max-width: 480px) {
    .servicio-section {
      padding: 0.75rem 0;
    }

    .servicio-left .servicio-content {
      transform: translateX(-50px);
    }

    .servicio-right .servicio-content {
      transform: translateX(50px);
    }

    .container {
      padding: 0 1rem;
    }

    .servicio-content {
      padding: 1.5rem;
      gap: 1.5rem;
    }

    .servicio-image {
      height: 250px;
    }

    .servicio-title {
      font-size: 1.6rem;
      margin-bottom: 1rem;
    }

    .servicio-description {
      font-size: 0.95rem;
      margin-bottom: 1.5rem;
    }

    .benefits-title {
      font-size: 1.1rem;
    }

    .benefit-item {
      font-size: 0.9rem;
    }

    .cta-button {
      padding: 0.75rem 1.25rem;
      font-size: 0.95rem;
    }
  }
</style>

<script>
  // Intersection Observer para animaciones
  document.addEventListener('DOMContentLoaded', function() {
    const servicioSections = document.querySelectorAll('.servicio-section');
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          // Añadir clase visible con un pequeño delay para efecto escalonado
          setTimeout(() => {
          entry.target.classList.add('visible');
          }, 50);
        }
      });
    }, {
      threshold: 0.2,
      rootMargin: '0px 0px -100px 0px'
    });

    servicioSections.forEach((section, index) => {
      // Añadir delay escalonado para cada sección
      const htmlSection = section as HTMLElement;
      htmlSection.style.transitionDelay = `${index * 0.1}s`;
      observer.observe(section);
    });
  });
</script>
